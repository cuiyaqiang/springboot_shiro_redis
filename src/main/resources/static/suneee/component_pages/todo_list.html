<!-- Page content -->
<div class="newpage-con">
	<div class="row">
		<div class="col-sm-12">
			<div class="block full">
				<div class="block-title">
					<ul class="nav nav-tabs">
						<li class="active">
							<a href="#all_todo" data-toggle="tab">全部任务</a>
						</li>
						<li class="">
							<a href="#start_me" data-toggle="tab">我发起的</a>
						</li>
						<li class="">
							<a href="#done_me" data-toggle="tab">我处理的</a>
						</li>
					</ul>
				</div>
				<div class="tab-content">
					<div class="tab-pane fade in active" id="all_todo">
						<div class="table-options clearfix">
							<div class="pull-left tab-search">
								<label class="control-label" for="example-select">任务状态</label>
								<select id="example-select" name="example-select" class="form-control" size="1">
									<option value="0">全部</option>
									<option value="1">未处理</option>
									<option value="2">已处理</option>
								</select>
								<label class="control-label" for="example-select">任务类型</label>
								<select id="example-select" name="example-select" class="form-control" size="1">
									<option value="0">全部</option>
									<option value="1">采购订单</option>
									<option value="2">贷款申请</option>
									<option value="3">赠品出库</option>
								</select>
								<label class="control-label" for="example-select">发起人</label>
								<input type="text" id="example-text-input" name="example-text-input" class="form-control">
								<label class="control-label" for="example-select">处理人</label>
								<input type="text" id="example-text-input" name="example-text-input" class="form-control">
								<button type="submit" class="btn btn-sm btn-primary"><i class="fa fa-search"></i> 查询</button>
							</div>
							<div class="btn-group btn-group-sm pull_ml">
								<a href="javascript:void(0)" class="btn btn-default" data-toggle="tooltip" title="刷新"><i class="fa fa-refresh"></i></a>
								<a href="javascript:void(0)" class="btn btn-default" data-toggle="tooltip" title="打印表格"><i class="fa fa-print"></i></a>
								<div class="btn-group btn-group-sm">
									<a href="javascript:void(0)" class="btn btn-default pull-right dropdown-toggle" data-toggle="dropdown"><i class="fa fa-cog"></i> <span class="caret"></span></a>
									<ul class="dropdown-menu dropdown-custom dropdown-menu-right" style="min-width: 150px;">
										<li class="dropdown-header">数据显示/隐藏</li>
										<li>
											<a href="javascript:void(0)" class="toggle-vis" data-column="4"><i class="fa fa-toggle-on pull-right"></i> 部门编码</a>
											<a href="javascript:void(0)" class="toggle-vis" data-column="9"><i class="fa fa-toggle-on pull-right"></i> 操作码</a>
											<a href="javascript:void(0)" class="toggle-vis" data-column="10"><i class="fa fa-toggle-on pull-right"></i> 分级编码</a>
											<a href="javascript:void(0)" class="toggle-vis" data-column="11"><i class="fa fa-toggle-on pull-right"></i> 是否末级</a>
										</li>
									</ul>
								</div>
							</div>
						</div>
						<div class="table-responsive">
							<table id="todo-table" class="table table-striped table-vcenter table-bordered table-condensed table-hover">
								<thead>
									<tr>
										<th class="text-center" width="40">序号</th>
										<th>业务号</th>
										<th>业务类型</th>
										<th>发起人</th>
										<th>创建时间</th>
										<th class="text-center">当前处理人</th>
										<th>最近处理时间</th>
										<th class="text-center">状态</th>
										<th class="text-center">操作</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td class="text-center"></td>
										<td><a href="#"><strong>10255</strong></a></td>
										<td>供应商结算</td>
										<td>王小明</td>
										<td>2017-05-28 18:30</td>
										<td class="text-center">周星星</td>
										<td>2017-05-28 19:30</td>
										<td class="text-center">
											<label class="label label-danger" title="待处理">待处理</label>
										</td>
										<td class="text-center">
											<div class="btn-group-xs btn_operation">
												<a href="javascript:void(0)" data-toggle="tooltip" title="详情" class="btn btn-default"><i class="fa fa-search"></i></a>
												<a href="javascript:void(0)" data-toggle="tooltip" title="取消优先" class="btn btn-danger"><i class="fa fa-star-o label-icon"></i></a>
											</div>
										</td>
									</tr>
									<tr>
										<td class="text-center"></td>
										<td><a href="#"><strong>10255</strong></a></td>
										<td>供应商结算</td>
										<td>王小明</td>
										<td>2017-05-28 18:30</td>
										<td class="text-center">周星星</td>
										<td>2017-05-28 19:30</td>
										<td class="text-center">
											<label class="label label-danger" title="待处理">待处理</label>
										</td>
										<td class="text-center">
											<div class="btn-group-xs btn_operation">
												<a href="javascript:void(0)" data-toggle="tooltip" title="详情" class="btn btn-default"><i class="fa fa-search"></i></a>
												<a href="javascript:void(0)" data-toggle="tooltip" title="标注优先" class="btn btn-default"><i class="fa fa-star-o label-icon"></i></a>
											</div>
										</td>
									</tr>
									<tr>
										<td class="text-center"></td>
										<td><a href="#" class="text-muted">10255</a></td>
										<td>供应商结算</td>
										<td>王小明</td>
										<td>2017-05-28 18:30</td>
										<td class="text-center">周星星</td>
										<td>2017-05-28 19:30</td>
										<td class="text-center">
											<label class="label label-default" title="已处理">已处理</label>
										</td>
										<td class="text-center">
											<div class="btn-group-xs btn_operation">
												<a href="javascript:void(0)" data-toggle="tooltip" title="详情" class="btn btn-default"><i class="fa fa-search"></i></a>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="tab-pane fade" id="start_me">
						<p>表格2</p>
					</div>
					<div class="tab-pane fade" id="done_me">
						<p>表格3</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- END Page Content -->

<script>
	//数据搜索

	//表格设置
	var TablesTodo = function() {

		return {

			init: function() {
				/* Initialize Bootstrap Datatables Integration */
				App.datatables();
				var scrolly = ($(document).height() - 310) + "px";
				console.log(scrolly);
				/* Initialize Datatables */
				var t = $('#todo-table').DataTable({
					columnDefs: [{
						orderable: false,
						targets: [0,8] //设置不排序的列
					}],
					scrollY: scrolly,
					scrollX: true,
					scrollCollapse: true,
					"order": [
						[4, "desc"]
					], //设置默认排序的列
					//"dom": '<"top"f>rt<"bottom"lpi>',//自定义工具栏
					"dom": 'rt<"bottom"lpi>', //自定义工具栏，隐藏默认搜索框
					"bAutoWidth": false,
					pageLength: 10, //设置默认显示行数
					//paging: false,
//					fixedColumns: {
//						leftColumns: 3
//					},
					lengthMenu: [
						[10, 20, 30, -1],
						[10, 20, 30, '全部']
					]
				});
				console.log(t.settings(scrollY));
				//动态显示隐藏列
				$('a.toggle-vis').on('click', function(e) {
					e.preventDefault();
					// Get the column API object
					var column = t.column($(this).attr('data-column'));
					// Toggle the visibility
					column.visible(!column.visible());
					//切换样式
					if($(this).find("i").hasClass('fa-toggle-on')) {
						$(this).find("i").removeClass('fa-toggle-on');
						$(this).find("i").addClass('fa-toggle-off');
					} else {
						$(this).find("i").addClass('fa-toggle-on');
						$(this).find("i").removeClass('fa-toggle-off');
					}
				});

				//增加排序列表
				t.on('order.dt search.dt',
					function() {
						t.column(0, {
							"search": 'applied',
							"order": 'applied'
						}).nodes().each(function(cell, i) {
							cell.innerHTML = i + 1;
						});
					}).draw();

				/* Add placeholder attribute to the search input */
				//$('.dataTables_filter input').attr('placeholder', '搜索部门名称、编号、类型、上级部门、属性');
				/* Select/Deselect all checkboxes in tables */
				$('thead input:checkbox').click(function() {
					var checkedStatus = $(this).prop('checked');
					var table = $(this).closest('table');

					$('tbody input:checkbox', table).each(function() {
						$(this).prop('checked', checkedStatus);
					});
				});

				/* Table Styles Switcher */
				var genTable = $('#todo-table');
			}
		};
	}();
	$(function() {
		TablesTodo.init();
	});
</script>